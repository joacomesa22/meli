---
import LinkBlend from "@components/global/LinkBlend.astro";
---

<section id="hero" class="home-dark-section hero flex min-h-screen items-center p-4">
	<div class="hero-bg pointer-events-none absolute inset-0 z-0">
		<div class="hero-bg-inner absolute inset-0">
			<img class="bg-static absolute inset-0 h-full w-full object-cover" src="/images/example4.jpg" alt="hero background" />
		</div>
	</div>

	<div class="mx-auto flex h-full flex-col items-center py-4 lg:py-10">
		<div class="relative z-10 flex flex-col items-center justify-around pb-10 pt-20 lg:rounded-2xl">
			<div class="flex flex-col items-center text-white">
				<div class="flex justify-center">
					<h1 class="md:text-7 text-center text-5xl font-light uppercase sm:text-7xl">
						<span>Diseño y Producción de</span>
						<span class="rotator relative inline-flex h-20 w-full justify-center">
							<span>merchandising</span><span>papelería</span><span>souvenirs</span><span>objetos</span><span>recuerdos</span>
						</span>
					</h1>
				</div>
				<div class="flex flex-col items-center gap-5 text-center lg:gap-10">
					<p class="lg:text-light max-w-xl text-balance">
						Materializamos lo efímero para que el recuerdo nunca termine. Diseñamos el vínculo tangible entre tu evento y quienes lo
						viven.
					</p>
					<div class="flex flex-col items-center justify-center gap-3 lg:col-start-1">
						<div class="rounded-lg bg-white" data-cursor-hover data-cursor-parallax>
							<a
								class="flex h-10 w-full max-w-52 flex-1 items-center justify-center px-4 py-2 text-xl text-zinc-900 transition-all sm:w-auto lg:h-10"
								aria-label="Contact Page"
								href="#contact">
								Contact
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<style>
		.hero {
			position: relative;
			border-radius: inherit;
			overflow: hidden;
		}
		.hero > div {
			grid-column: 1 / span 12;
		}

		/* Hero appearance */
		.hero h1,
		.hero h2,
		.hero h3 {
			margin: 0;
		}
		.hero h1 {
			margin: 0;
			position: relative;
			overflow: hidden;
			visibility: hidden;
		}
		.hero h1 > div {
			position: relative;
			margin: 0;
		}

		/* Hero background slider */
		/* Hero background slider: full-bleed but with an inner padded frame */
		.hero-bg {
			/* outer container fills the hero */
		}

		.hero-bg .hero-bg-inner {
			/* create the transparent border inside the full-width container */
			position: absolute;
			inset: 1rem;
			border-radius: 0.75rem;
			overflow: hidden;
		}

		.hero-bg .bg-static {
			width: 100%;
			height: 100%;
			object-fit: cover;
			/* single fixed background image, no opacity transitions */
		}
		.hero :global(.split-parent) {
			overflow: hidden;
		}
		.hero :global(.split-child) {
			display: inline-block;
		}

		/* Text rotator */
		.rotator > span {
			position: absolute;
		}

		.rotator > span:not(:nth-child(1)) {
			opacity: 0;
		}
	</style>

	<script>
		import { gsap } from "gsap";
		import { ScrollTrigger } from "gsap/ScrollTrigger";
		import { SplitText } from "gsap/SplitText";
		import { ScrollToPlugin } from "gsap/ScrollToPlugin";

		gsap.registerPlugin(ScrollTrigger, SplitText, ScrollToPlugin);

		function init() {
			const childSplit = new SplitText(".hero h1", {
				type: "lines",
				linesClass: "split-child",
			});
			const parentSplit = new SplitText(".hero h1", {
				type: "lines",
				linesClass: "split-parent",
			});

			gsap.timeline()
				.from(childSplit.lines, {
					duration: 1.5,
					yPercent: 100,
					ease: "power4",
					stagger: 0.1,
				})
				.set(".hero h1", { visibility: "visible" }, "<")
				.then(() => {
					const words = document.querySelectorAll(".hero .rotator > span");

					let rotatorTimeline = gsap.timeline({ repeat: -1 });
					rotatorTimeline.timeScale(0.5);

					for (let i = 0; i < words.length; i++) {
						let delay = i - 1;
						let wordTL = gsap.timeline();
						if (i !== 0) {
							gsap.set(words[i], { opacity: 1 });
							wordTL.from(words[i], { duration: 1, yPercent: 100, opacity: 0, ease: "power4.out" });
						} else {
							// Handle the first one specially
							delay += 1;
							gsap.set(words[0], { opacity: 1, yPercent: 0 });
						}

						if (i !== words.length - 1) {
							wordTL.to(words[i], { duration: 1, yPercent: -100, opacity: 0, ease: "power4.out" });
						}
						rotatorTimeline.add(wordTL, delay);
					}
				});

			// Background slider: crossfade slides every ~2s (0.6s in, 0.8s hold, 0.6s out)
			// Single fixed background image — no crossfade timeline needed

			var goProjectsButton = document.getElementById("go-projects-button");
			goProjectsButton?.addEventListener("click", function () {
				gsap.to(window, { duration: 0.5, scrollTo: "#projects" });
			});
		}

		document.removeEventListener("DOMContentLoaded", init); // astro:page-load
		document.addEventListener("DOMContentLoaded", init); // astro:page-load
	</script>
</section>
